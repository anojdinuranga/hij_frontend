<!DOCTYPE html>
<html lang="en">

<head>
    <%-head%>
</head>

<body>

    <%-nav%>

    <div class="mx-5">

        <div class="mt-5">
          <table class="table1">
            <thead>
              <tr>
                <th scope="col">Name</th>
                <th scope="col">Employee number</th>
                <th scope="col">More Detail</th>
              </tr>
            </thead>
            <tbody>
              
              <% requestList.forEach((item, index)=>{%>
                <tr>
                  <td><%=item.name%></td>
                  <td><%=item.employee_number%></td>
                  <td>
                    <div class="dropdown dropend">
                      <button class="btn btn-sm p-0" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                        <img src="/assets/images/icons/Group 482180.svg" alt="dropdown" width="25" height="25">
                      </button>
                      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton1">
                        <li class="delete-button" data-id="<%=item.id%>"><a class="dropdown-item" href="#" >Delete</a></li>
                        <li><a class="dropdown-item" href="/edit-client/<%=item.id%>">Edit</a></li>
                      </ul>
                    </div>
                  </td>
                  </td>
                  <td>
                  </td>
                </tr>
              <%})%>
        
               
            </tbody>
          </table>
        </div>

        <%-script%>
        <script>
          $(document).ready(function(){
            $('.delete-button').click(function(e){
              e.preventDefault();
              var id = $(this).data('id');
              deleteClient(id);
            });
          });
          function deleteClient(id){
            showAlert({
                message:"Are you sure you want to delete this client?",
                closeText:'no',
                acceptText:'yes',
                acceptFunction: ()=>{
                  $.ajax({
                    url: '/api/v1/client/delete',
                    type: 'POST',
                    data: {id:id},
                    success: function(response){
                      if(response.status){
                        location.reload();
                      }else{
                        showAlert({
                          message:"ERROR: "+response.message,
                          closeText:'ok',
                        });
                          console.log("ðŸš€ ~ deleteClient ~ response:", response)
                      }
                    },
                    error: function(err){
                      console.log(err);
                    }
                  });
                },
            });
          }
        </script>
       
</body>

</div>

</html>