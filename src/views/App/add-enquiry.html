<!DOCTYPE html>
<html lang="en">

<head>
    <%-head%>
</head>

<body>

    <%-nav%>

        <div class="mx-5">

            <div class="row mt-5">
                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">CR No</label>
                        <input type="text" class="form-control w-full" id="crNo">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Buyer</label>
                        <div class="">
                            <select name="" id="buyer" class="form-control w-full">
                            </select>
                        </div>

                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Enquiry Date</label>
                        <input type="date" class="form-control w-full" id="enquiryDate">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Style No</label>
                        <input type="number" class="form-control w-full" id="styleNo">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Image</label>
                        <input type="file" class="form-control w-full" id="image">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Fabric blend</label>
                        <input type="text" class="form-control w-full" id="fabricBlend">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Combo No</label>
                        <input type="number" class="form-control w-full" id="comboNo">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Value added process</label>
                        <div class="">
                            <select name="" id="valueAddedProcess" class="form-control w-full">
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Projected Qty pieces</label>
                        <input type="number" class="form-control w-full" id="projectedQty">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">SAM/Pcs</label>
                        <input type="number" class="form-control w-full" id="samPcs">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Lapdip No</label>
                        <input type="number" class="form-control w-full" id="lapdipNo">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Expected Order placement date</label>
                        <input type="date" class="form-control w-full" id="orderPlacementDate">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Quoted Price</label>
                        <input type="number" class="form-control w-full" id="quotedPrice">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Fabric price</label>
                        <input type="number" class="form-control w-full" id="fabricPrice">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Fabric Consumption</label>
                        <input type="text" class="form-control w-full" id="fabricConsumption">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Yarn Price</label>
                        <input type="number" class="form-control w-full" id="yarnPrice">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Lapdip cost</label>
                        <input type="number" class="form-control w-full" id="lapdipCost">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Trim Cost</label>
                        <input type="number" class="form-control w-full" id="trimCost">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">Tech-pack</label>
                        <input type="file" class="form-control w-full" id="techPack">
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group w-100 mb-5">
                        <label class="form-label mb-3" for="">GSM</label>
                        <input type="number" class="form-control w-full" id="gsm">
                    </div>
                </div>
            </div>

            <div class="footer">
                <button type="submit" class="btn btn-primary mb-4 theme-primary-btn" onclick="addEnquiry()">Save</button>
            </div>

            <%-script%>

                <script>
                    var uploadedFile = '';

                    $(document).ready(function () {
                        $.ajax({
                            url: '/api/v1/client/list',
                            type: 'POST',
                            contentType: 'application/json',
                            data: {},
                            success: function (response) {
                                if (response.status) {
                                    console.log("ðŸš€ ~ response:", response.data)

                                    const buyer = document.getElementById('buyer');

                                    response.data.forEach(data => {
                                        const option = document.createElement('option');
                                        option.value = data.id; // Assuming 'id' is a unique identifier
                                        option.textContent = data.name; // Assuming 'name' is the name of the image
                                        buyer.appendChild(option);
                                    });
                                    
                                } else {
                                    showAlert({
                                        message: "ERROR: " + response.message,
                                        closeText: 'ok',
                                    });
                                }
                            },
                            error: function (error) {
                                console.log(error);
                            }
                        });
                    });

                    function addEnquiry() {

                        $.ajax({
                            url: '/api/v1/order/add',
                            type: 'POST',
                            contentType: 'application/json',
                            data: JSON.stringify({
                                "crNumber": $("#crNo").val(),
                                "buyerId": $("#buyer").val(),
                                "enquiryDate": $("#enquiryDate").val(),
                                "styleNo": $("#styleNo").val(),
                                "image": uploadedFile == '' ? null : uploadedFile,
                                "fabricBlend": $("#fabricBlend").val(),
                                "comboNo": $("#comboNo").val(),
                                "valueAddedProcess": $("#valueAddedProcess").val(),
                                "projectedQtyPieces": $("#projectedQty").val(),
                                "samPerPiece": $("#samPcs").val(),
                                "lapdipNo": $("#lapdipNo").val(),
                                "expectedOrderPlacementDate": $("#orderPlacementDate").val(),
                                "quotedPrice": $("#quotedPrice").val(),
                                "fabricPrice": $("#fabricPrice").val(),
                                "fabricConsumption": $("#fabricConsumption").val(),
                                "yarnPrice": $("#yarnPrice").val(),
                                "lapdipCost": $("#lapdipCost").val(),
                                "trimCost": $("#trimCost").val(),
                                "techPack": uploadedFile == '' ? null : uploadedFile,
                                "gsm": $("#gsm").val()
                            }),
                            success: function (response) {
                                if (response.status) {
                                    showAlert({
                                        message: "Success: Enquiry added successfully",
                                        closeText: 'ok',
                                        closeFunction: function () {
                                            window.location.href = '/enquiry-list';
                                        },
                                    });
                                } else {
                                    showAlert({
                                        message: "ERROR: " + response.message,
                                        closeText: 'ok',
                                    });
                                }
                            },
                            error: function (error) {
                                console.log(error);
                            }
                        });

                    };
                </script>
</body>

</div>

</html>